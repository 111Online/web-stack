@using NHS111.Models.Models.Web
@model  OutcomeViewModel
@{
    var services = Model.DosCheckCapacitySummaryResult.Success.Services;
}
@if (services.Any(s => s.CallbackEnabled))
{
    <details>
        <summary>
            <span class="summary">@string.Format("{0}", ViewData.Keys.Contains("CallbackTitle") ? ViewData["CallbackTitle"] : "We can arrange for someone to phone you")</span>
        </summary>
        <div class="panel panel-border-narrow">
            <p>They will check through the answers you have entered and give you advice on what to do next</p>
            <div>
                @foreach (var callbackService in services.Where(s => s.CallbackEnabled))
                {
                    <h3>@WebUtility.HtmlDecode(callbackService.Name)</h3>

                    if (!callbackService.IsOpen)
                    {
                        <div class="service-status">
                            @WebUtility.HtmlDecode(callbackService.ServiceOpeningTimesMessage)
                        </div>
                    }

                    using (Html.BeginForm("PersonalDetails", "Outcome", FormMethod.Post))
                    {
                        @Html.Partial("_CommonHiddenFieldsOutcomeViewModel", Model)
                        @Html.Partial("_CommonHiddenFieldsCareAdviceViewModel", Model)
                        @Html.Hidden("SelectedServiceId", @callbackService.Id)
                        <div>
                            <input class="button alternative-care-button-link" type="submit" name="PersonalDetails" value="Book a call"/>
                        </div>
                    }
                }
            </div>
        </div>
    </details>
}
