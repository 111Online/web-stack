@using NHS111.Models.Models.Web
@model  OutcomeViewModel
@{
    var services = Model.DosCheckCapacitySummaryResult.Success.Services;
}
@if (services.Any(s => s.CallbackEnabled))
{
    <details>
        <summary>
            <span class="summary">@string.Format("{0}", ViewData.Keys.Contains("CallbackTitle") ? ViewData["CallbackTitle"] : "We can arrange for someone to phone you")</span>
        </summary>
        <div>
            <div class="cards">
                @foreach (var callbackService in services.Where(s => s.CallbackEnabled))
                {
                    <div class="card">
                        <h3>@WebUtility.HtmlDecode(callbackService.Name)</h3>

                        @if (!callbackService.IsOpen)
                        {
                            <p class="card__details service-status">@WebUtility.HtmlDecode(callbackService.ServiceOpeningTimesMessage)</p>
                        }

                        @using (Html.BeginForm("PersonalDetails", "Outcome", FormMethod.Post))
                        {
                            @Html.Partial("_CommonHiddenFieldsOutcomeViewModel", Model)
                            @Html.Partial("_CommonHiddenFieldsCareAdviceViewModel", Model)
                            @Html.Hidden("SelectedServiceId", @callbackService.Id)
                            <hr />
                            <p>They will check through the answers you have entered and give you advice on what to do next</p>
                            <button class="" type="submit" name="PersonalDetails" value="Book a call">Book a call</button>
                        }
                    </div>
                }
            </div>
        </div>
    </details>
}
