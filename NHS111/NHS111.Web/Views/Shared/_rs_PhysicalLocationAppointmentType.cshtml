@using Newtonsoft.Json
@using NHS111.Models.Models.Web
@model  OutcomeViewModel

@{
    var recommendedService = Model.DosCheckCapacitySummaryResult.Success.RecommendedService;
}

<div class="service-details-container">

    <div class="details-1 service-details">
        <div class="unit address">
            <p>
                @WebUtility.HtmlDecode(recommendedService.PublicName)<br />
                @foreach (var address in recommendedService.AddressLines)
                {
                    @WebUtility.HtmlDecode(address)<br />
                }
            </p>
        </div>
        <div class="unit hours">
            <p>
                @Html.Partial("_ServiceOpeningTimes", recommendedService, ViewData)
            </p>
        </div>
    </div>

    @*
        If an appointment is required its a public phone type only
        This is a go to so no contact details
        <div class="subroutine measure">
            <div class="callout callout--attention">
                You must call <b>@recommendedService.ContactDetails</b> to make an appointment
            </div>
        </div>
    *@

    <div class="details-2 service-details cards--goto">
        <div class="unit directions">
            <p>
                @*is this in miles?*@
                @recommendedService.Distance miles away<br>
                @using (Html.BeginForm("GetDirections", "Outcome", FormMethod.Post))
                {
                    @Html.HiddenFor(m => m.SessionId)
                    @Html.HiddenFor(m => m.JourneyId)
                    @Html.HiddenFor(m => m.JourneyJson)
                    @Html.HiddenFor(m => m.Id)
                    @Html.Hidden("SelectedServiceId", recommendedService.Id)
                    @Html.Hidden("SelectedServiceName", recommendedService.Name)
                    @Html.Hidden("SelectedServiceAddress", recommendedService.Address)
                    <button class="button--link card__directions--fallback" type="submit">Get directions</button>
                <p><a class="card__directions" style="display: none;" target="_blank" href="@string.Format("https://www.google.com/maps/dir/?api=1&origin={0}&destination={1}", Model.CurrentPostcode, recommendedService.Address)">Get directions</a></p>
            }
                </p>
                <p>
                    @using (Html.BeginForm("ChangePostcode", "Outcome", FormMethod.Post))
                    {
                        @Html.Partial("_CommonHiddenFieldsOutcomeViewModel", Model)
                        @Html.Partial("_CommonHiddenFieldsCareAdviceViewModel", Model)
                        @Html.Partial("_rs_ChangePostcodeLink")
                    }
                </p>
            </div>
        </div>

    </div>

    @{
        var mapService = JsonConvert.SerializeObject(new[] { Model });
    }
    <script>
    window.mapServices = @Html.Raw(mapService);
    window.currentPostcode = "@Html.Raw(Model.CurrentPostcode)";
    </script>

